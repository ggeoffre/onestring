# SPDX-License-Identifier: GPL-3.0-or-later
# Copyright (C) 2025 ggeoffre, LLC

 █████       ██████████   █████████     ███████     █████████
░░███       ░░███░░░░░█  ███░░░░░███  ███░░░░░███  ███░░░░░███
 ░███        ░███  █ ░  ███     ░░░  ███     ░░███░███    ░░░
 ░███        ░██████   ░███         ░███      ░███░░█████████
 ░███        ░███░░█   ░███    █████░███      ░███ ░░░░░░░░███
 ░███      █ ░███ ░   █░░███  ░░███ ░░███     ███  ███    ░███
 ███████████ ██████████ ░░█████████  ░░░███████░  ░░█████████
░░░░░░░░░░░ ░░░░░░░░░░   ░░░░░░░░░     ░░░░░░░     ░░░░░░░░░


This exercise combines the first three assignments into a fully operational end-to-end solution that logs sensor data through a Flask web API, stores it in MongoDB, retrieves it as CSV, and exposes purge and reporting routes—all driven by refined AI prompts. The goal is to show how small, well-defined Python and Flask “lego pieces” (individual functions, routes, and database helpers) can be snapped together to form a complete working system, perfectly aligned with the CodeMash “Legos” theme of building larger solutions from simple, reusable blocks. By structuring the project into modular Flask routes and separate Mongo utility functions, you learn how to compose functionality cleanly, test each piece independently, and then use the same workflow as earlier: run the code, extract the functions, generate prompts that recreate them, and refine those prompts for higher-quality output. This combined assignment demonstrates how prompt-driven development can scale from isolated components to a functioning data pipeline, while still keeping the tools (Python, Flask, Mongo) simple enough to focus on AI-assisted code generation—not framework complexity.



{
    "recorded" : 1768570200,
    "location" : "den",
    "sensor" : "bmp280",
    "measurement" : "temperature",
    "units" : "C",
    "value" : 22.3
}


I. Start Your Development Environment (recommend using python, flask and mongo):

  1. Launch Docker Desktop, and use the terminal within Docker Desktop to:
    A. Run a mongo database docker container

      docker run --name mongo-container -p 27017:27017 -d mongo:8.0

    B. Run a python docker container and attach to the mongo database container

      docker run --name python-container -p 8080:8080 -v ~/Workspace/projects/:/usr/src/python -d python:3.13.5 sleep infinity

  2. Launch VS Code, Open Folder, and Create a Terminal to:
    A. Connect to the python container from teh VS Code Terminal

      docker exec -it -w /usr/src/python python-container /bin/bash

  3. Create the following file structure within VS Code:
    ./python/legos
    ./python/legos/flask-app/flask_mongo.py
    ./python/legos/flask-app/app.py
    ./python/legos/flask-app/requirements.txt


II. Modify the following prompts to be language and framework specific (recommend using python and flask):

  1. in the flask_mongo.py source file, create a seperate method named log_sensor_data that accepts a json string and saves the data to a mongo database
  2. from the POST /log route method, call the log_sensor_data in the flask_mongo.py source file using the JSON data from the request
  3. in the flask_mongo.py source file, create a seperate method named fetch_sensor_data that returns a csv string of all data stored in the mongo database
  4. from the POST /report route method, call the fetch_sensor_data in the flask_mongo.py source file and return the CSV string as a downloadable file
  5. in the flask_mongo.py source file, create a seperate method named purge_sensor_data that deletes all data in the mongo database
  6. from either the POST or GET /purge route method, call the purge_sensor_data in the flask_mongo.py source file


III. Run your python Code

  python --version
  pip install --upgrade pip
  pip install -r requirements.txt
  python app.py


IV. Once fully operational, copy each of the four functions individually, and add it to the following AI prompt...

  "Using the following source code, generate an AI prompt that would produce this code:"

    compared to...

  "Using the following source code to generate an AI prompt, using simple english, that would produce this code:"

    NOTE: Cute/paste the code you generated above that sucessfully ran.


V. Now take all of the original prompts from II above, and add it to the following AI prompt...

  "How could each of these prompts be written in a manner to produce 'better' code:"

    NOTE: use any instruction to replace 'better' (like cleaner, efficient, optimized, readable, concise, performant, scalable, maintainable, secure, etc.)


EXTRA PROMPTS:

  A. Using the ABC for sensor_data_access_protocol, implement a method to instantiate a new sensor data access object based on an environment variable.
  B. Implement a better logging mechanism for the sensor data access object.

  Now run the generated code and these prompts back through AI as you did in IV and V previously.


BEYOND FLASK, MONGO & PYTHON:

  Use the same technique for another python framework like django
  Use the same technique for other databases like Postgres, MySQL, Redis and Cassandra
  Use the same technique for other languages and frameworks like Go gin, Java spring, Rust acix and Swift vapor
